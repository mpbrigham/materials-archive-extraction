{
  "name": "Materials Extraction Pipeline",
  "nodes": [
    {
      "parameters": {
        "format": "resolved",
        "downloadAttachments": true,
        "options": {}
      },
      "id": "a017ddb3-0ae7-45e5-a9d2-1e2e9369f8c4",
      "name": "Email Trigger",
      "type": "n8n-nodes-base.emailReadImap",
      "typeVersion": 2,
      "position": [240, -160],
      "credentials": {
        "imap": {
          "id": "h0Vity66wkDfDonL",
          "name": "IMAP account"
        }
      }
    },
    {
      "parameters": {
        "url": "http://python-api:8000/validate",
        "method": "POST",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { email_context: $json, attachments: Object.values($binary).map(a => ({fileName: a.fileName, mimeType: a.mimeType, data: a.data})) } }}",
        "options": {
          "retryOnFail": true,
          "retryLimit": 3
        }
      },
      "id": "1d8c1563-0ab6-4bb1-9117-49edf2789caf",
      "name": "Document Validator",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [460, -160]
    },
    {
      "parameters": {
        "url": "http://python-api:8000/extract",
        "method": "POST",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ [$json] }}",
        "options": {
          "retryOnFail": true,
          "retryLimit": 3
        }
      },
      "id": "6733d7f1-769e-46d5-95da-7f9330d901ed",
      "name": "LLM Extraction",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [680, -160]
    },
    {
      "parameters": {
        "url": "http://python-api:8000/process",
        "method": "POST",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ [$json] }}",
        "options": {
          "retryOnFail": true,
          "retryLimit": 3
        }
      },
      "id": "2f9e9e79-c0d7-458a-a92b-9f5a175aba42",
      "name": "Result Processor",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [900, -160]
    },
    {
      "parameters": {
        "fromEmail": "={{ $json.from }}",
        "toEmail": "={{ $json.to }}",
        "subject": "={{ $json.subject }}",
        "emailFormat": "html",
        "html": "={{ $json.body }}",
        "options": {}
      },
      "id": "e6709bf9-b2e5-4abb-9d04-c914dee479ec",
      "name": "Send Notification",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [1120, -160],
      "credentials": {
        "smtp": {
          "id": "l29wKFfdODrn2qgi",
          "name": "SMTP account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Email Trigger": {
      "main": [[{ "node": "Document Validator", "type": "main", "index": 0 }]]
    },
    "Document Validator": {
      "main": [[{ "node": "LLM Extraction", "type": "main", "index": 0 }]]
    },
    "LLM Extraction": {
      "main": [[{ "node": "Result Processor", "type": "main", "index": 0 }]]
    },
    "Result Processor": {
      "main": [[{ "node": "Send Notification", "type": "main", "index": 0 }]]
    }
  },
  "active": false,
  "settings": { "executionOrder": "v1" },
  "versionId": "materials-extraction-v2",
  "meta": { "instanceId": "materials-extraction-pipeline" },
  "id": "materials-extraction-pipeline",
  "tags": []
}
